version: v0.1

# ── Network Listener ──────────────────────────────────────────────────
listeners:
  - name: "api"
    address: "0.0.0.0"
    port: 8801
    timeout: "300s"

# ── Domain Signals ────────────────────────────────────────────────────
# Domain names must match the classifier's category_mapping.json output
# (space-separated, not underscores).
signals:
  domains:
    - name: "computer science"
      description: "Computer science and programming"
      mmlu_categories: ["computer science"]
    - name: "engineering"
      description: "Engineering and technical problem-solving"
      mmlu_categories: ["engineering"]
    - name: "math"
      description: "Mathematics and quantitative reasoning"
      mmlu_categories: ["math"]
    - name: "physics"
      description: "Physics and physical sciences"
      mmlu_categories: ["physics"]
    - name: "biology"
      description: "Biology and life sciences"
      mmlu_categories: ["biology"]
    - name: "chemistry"
      description: "Chemistry and chemical sciences"
      mmlu_categories: ["chemistry"]
    - name: "health"
      description: "Health and medical information"
      mmlu_categories: ["health"]
    - name: "business"
      description: "Business and management"
      mmlu_categories: ["business"]
    - name: "law"
      description: "Legal questions and law"
      mmlu_categories: ["law"]
    - name: "psychology"
      description: "Psychology and mental health"
      mmlu_categories: ["psychology"]
    - name: "history"
      description: "Historical questions and culture"
      mmlu_categories: ["history"]
    - name: "economics"
      description: "Economics and finance"
      mmlu_categories: ["economics"]
    - name: "philosophy"
      description: "Philosophy and ethics"
      mmlu_categories: ["philosophy"]
    - name: "other"
      description: "General knowledge and miscellaneous"
      mmlu_categories: ["other"]

# ── Routing Decisions ─────────────────────────────────────────────────
decisions:
  - name: "coding"
    description: "Route coding and engineering queries to coding model"
    priority: 100
    rules:
      operator: "OR"
      conditions:
        - type: "domain"
          name: "computer science"
        - type: "domain"
          name: "engineering"
    modelRefs:
      - model: "__MODEL_CODING__"
        use_reasoning: false
    plugins:
      - type: "pii"
        configuration:
          enabled: true
          pii_types_allowed: []
      - type: "router_replay"
        configuration:
          enabled: true
          max_records: 200
          capture_request_body: true
          capture_response_body: true
          max_body_bytes: 4096

  - name: "general"
    description: "Default route for all other queries"
    priority: 1
    rules:
      operator: "OR"
      conditions:
        - type: "domain"
          name: "other"
        - type: "domain"
          name: "math"
        - type: "domain"
          name: "physics"
        - type: "domain"
          name: "biology"
        - type: "domain"
          name: "chemistry"
        - type: "domain"
          name: "health"
        - type: "domain"
          name: "business"
        - type: "domain"
          name: "law"
        - type: "domain"
          name: "psychology"
        - type: "domain"
          name: "history"
        - type: "domain"
          name: "economics"
        - type: "domain"
          name: "philosophy"
    modelRefs:
      - model: "__MODEL_GENERAL__"
        use_reasoning: false
    plugins:
      - type: "pii"
        configuration:
          enabled: true
          pii_types_allowed: []
      - type: "router_replay"
        configuration:
          enabled: true
          max_records: 200
          capture_request_body: true
          capture_response_body: true
          max_body_bytes: 4096

# ── Backend Providers ─────────────────────────────────────────────────
providers:
  models:
    - name: "__MODEL_CODING__"
      endpoints:
        - name: "litellm"
          weight: 1
          endpoint: "__LITELLM_ENDPOINT__:443"
          protocol: "https"
      access_key: "__LITELLM_API_KEY__"

    - name: "__MODEL_GENERAL__"
      endpoints:
        - name: "litellm"
          weight: 1
          endpoint: "__LITELLM_ENDPOINT__:443"
          protocol: "https"
      access_key: "__LITELLM_API_KEY__"

  default_model: "__MODEL_GENERAL__"

# ── Embedding Models ──────────────────────────────────────────────────
embedding_models:
  use_cpu: true
